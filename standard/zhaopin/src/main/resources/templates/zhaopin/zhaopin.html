<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<head>
    <title>招聘推广</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"/>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
    <script type="application/javascript" th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{http://res.wx.qq.com/open/js/jweixin-1.0.0.js}" type="text/javascript"></script>
    <script type="application/javascript" th:src="@{/js/weixin.js}"></script>
    <script type="application/javascript" th:inline="javascript">
        wx.config({
            debug: true,
            appId: [[${ret.appId}]],
            timestamp: [[${ret.timestamp}]],
            nonceStr: [[${ret.nonceStr}]],
            signature: [[${ret.signature}]],
            jsApiList: [
                'checkJsApi',
                'onMenuShareTimeline',
                'onMenuShareAppMessage',
                'onMenuShareQQ',
                'onMenuShareWeibo',
                'hideMenuItems',
                'showMenuItems',
                'hideAllNonBaseMenuItem',
                'showAllNonBaseMenuItem',
                'translateVoice',
                'startRecord',
                'stopRecord',
                'onRecordEnd',
                'playVoice',
                'pauseVoice',
                'stopVoice',
                'uploadVoice',
                'downloadVoice',
                'chooseImage',
                'previewImage',
                'uploadImage',
                'downloadImage',
                'getNetworkType',
                'openLocation',
                'getLocation',
                'hideOptionMenu',
                'showOptionMenu',
                'closeWindow',
                'scanQRCode',
                'chooseWXPay',
                'openProductSpecificView',
                'addCard',
                'chooseCard',
                'openCard'
            ]
        });

        wx.ready(function () {

            document.querySelector('#onMenuShareTimeline').onclick = function () {
                wx.onMenuShareTimeline({
                    title: '互联网之子',
                    link: [[${link}]],
                    imgUrl: 'http://demo.open.weixin.qq.com/jssdk/images/p2166127561.jpg',
                    trigger: function (res) {
                        // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回
                        alert('用户点击分享到朋友圈');
                    },
                    success: function (res) {
                        alert('已分享');
                    },
                    cancel: function (res) {
                        alert('已取消');
                    },
                    fail: function (res) {
                        alert(JSON.stringify(res));
                    }
                });
                alert('已注册获取“分享到朋友圈”状态事件');
            };


            // 1 判断当前版本是否支持指定 JS 接口，支持批量判断
            document.querySelector('#checkJsApi').onclick = function () {
                wx.checkJsApi({
                    jsApiList: [
                        'onMenuShareTimeline'
                    ],
                    success: function (res) {
//                        alert(JSON.stringify(res));
                    }
                });
            };

            var shareData = {
                title: '哎呀呀招聘',
                link: [[${link}]],
                imgUrl: 'http://demo.open.weixin.qq.com/jssdk/images/p2166127561.jpg',
                desc: '哎呀呀招聘',
            };
            wx.onMenuShareTimeline(shareData);
            wx.onMenuShareAppMessage(shareData);


            // 12 微信卡券接口
            // 12.1 添加卡券
            document.querySelector('#addCard').onclick = function () {
                wx.addCard({
                    cardList: [
                        {
                            cardId: 'pDF3iY9tv9zCGCj4jTXFOo1DxHdo',
                            cardExt: {signature:"f54dae85e7807cc9525ccc127b4796e021f05b33",code: "", openid: "", timestamp: "1418301401"}
                        },
                        {
                            cardId: 'pDF3iY9tv9zCGCj4jTXFOo1DxHdo',
                            cardExt: {code: "", openid: "", timestamp: "1418301401", signature:"f54dae85e7807cc9525ccc127b4796e021f05b33"}
                        }
                    ],
                    success: function (res) {
                        alert('已添加卡券：' + JSON.stringify(res.cardList));
                    }
                });
            };



        });

        wx.error(function (res) {
            alert(res.errMsg);
        });
    </script>
 <!--   <script type="application/javascript" th:inline="javascript">
        wx.chooseCard({
            debug: true,
            cardType: [[${ret.card_type}]],// 卡券类型
            timestamp: [[${ret.time_stamp}]], // 卡券签名时间戳
            nonceStr: [[${ret.nonce_str}]], // 卡券签名随机串
            signType: 'SHA1', // 签名方式，默认'SHA1'
            cardSign: [[${ret.signature}]], // 卡券签名
            success: function (res) {
                var cardList = res.cardList; // 用户选中的卡券列表信息
            }
        });
    </script>-->

</head>
<body ontouchstart="">
<div class="wxapi_container">
    <button class="btn btn_primary" id="checkJsApi">checkJsApi</button>
    <button class="btn btn_primary" id="onMenuShareTimeline">onMenuShareTimeline</button>
    <button class="btn btn_primary" id="chooseImage">选择图片</button>
    <button class="btn btn_primary" id="addCard">addCard</button>
    <div id="imagelist"></div>
</div>
</body>

</html>